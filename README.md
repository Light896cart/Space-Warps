# üî≠ Progressive Architecture Search for Galaxy Classification ‚Äî Solo Project by Artem Goncharov

> **–ê–≤—Ç–æ—Ä**: Artem Goncharov  
> **–°—Ç–∞—Ç—É—Å**: Solo –ø—Ä–æ–µ–∫—Ç, –≤—ã–ø–æ–ª–Ω–µ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Å –Ω—É–ª—è –∫–∞–∫ Junior ML Engineer  
> **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏**: PyTorch, Python, Hydra, OmegaConf, CV, NLP-–ø–æ–¥–æ–±–Ω—ã–µ –º–µ—Ç–æ–¥—ã –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–º –ø–æ–∏—Å–∫–µ  
> **–¶–µ–ª—å**: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–∏—Å–∫ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π CNN-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≥–∞–ª–∞–∫—Ç–∏–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π + –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–∫—Ä–∞—Å–Ω–æ–µ —Å–º–µ—â–µ–Ω–∏–µ z)  

---

## üí° –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ?

–≠—Ç–æ **–ø–µ—Ä–≤–∞—è –≤ —Å–≤–æ—ë–º —Ä–æ–¥–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏** (Progressive Architecture Search ‚Äî PAS), **—Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ–¥ –∑–∞–¥–∞—á—É –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≥–∞–ª–∞–∫—Ç–∏–∫** –≤ –∞—Å—Ç—Ä–æ–Ω–æ–º–∏–∏.  

–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö NAS (Neural Architecture Search), –≥–¥–µ –∏—â—É—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É "—Å –Ω—É–ª—è", –∑–¥–µ—Å—å —è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª **—ç–≤–æ–ª—é—Ü–∏–æ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥**:  
> **–ù–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ –º–æ–¥–µ–ª—å –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ "—Ä–∞—Å—Ç—ë—Ç" ‚Äî –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –Ω–æ–≤—ã–π —Å–≤—ë—Ä—Ç–æ—á–Ω—ã–π –±–ª–æ–∫, –∏ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∫–∞–Ω–∞–ª–æ–≤ —Å—Ä–µ–¥–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤.**

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ ‚Äî –≤–µ—Å–∞ **–∫–æ–ø–∏—Ä—É—é—Ç—Å—è, –º–∞—Å—à—Ç–∞–±–∏—Ä—É—é—Ç—Å—è –∏ —Å–ª–µ–≥–∫–∞ —à—É–º—è—Ç—Å—è** (jitter), —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–Ω–∞–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —à–∞–≥–æ–≤ –∏ –∏–∑–±–µ–∂–∞—Ç—å –ø–æ–ª–Ω–æ–≥–æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è. –≠—Ç–æ ‚Äî **–≥–∏–±—Ä–∏–¥ –º–µ–∂–¥—É transfer learning, weight inheritance –∏ —ç–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–º –±–∞–π–µ—Å–æ–≤—Å–∫–∏–º –ø–æ–∏—Å–∫–æ–º**.

–†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏—Ö –∫–∞—Ç–∞–ª–æ–≥–æ–≤: –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≥–∞–ª–∞–∫—Ç–∏–∫ + –∏—Ö –∫—Ä–∞—Å–Ω–æ–µ —Å–º–µ—â–µ–Ω–∏–µ (`z`) –∏ –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å (`z_err`).

---

## üß© –ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ?

–û–±—ã—á–Ω—ã–µ CNN —Ç—Ä–µ–±—É—é—Ç —Ä—É—á–Ω–æ–≥–æ –ø–æ–¥–±–æ—Ä–∞ –≥–ª—É–±–∏–Ω—ã, —á–∏—Å–ª–∞ –∫–∞–Ω–∞–ª–æ–≤, —Ä–∞–∑–º–µ—Ä–∞ —è–¥—Ä–∞ ‚Äî —ç—Ç–æ **–¥–æ—Ä–æ–≥–æ, –¥–æ–ª–≥–æ –∏ —Å—É–±—ä–µ–∫—Ç–∏–≤–Ω–æ**. –û—Å–æ–±–µ–Ω–Ω–æ –≤ –∞—Å—Ç—Ä–æ–Ω–æ–º–∏–∏, –≥–¥–µ:

- –î–∞–Ω–Ω—ã–µ –¥–æ—Ä–æ–≥–∏–µ (—Ç–µ–ª–µ—Å–∫–æ–ø—ã, –Ω–∞–±–ª—é–¥–µ–Ω–∏—è),
- –ö–ª–∞—Å—Å–æ–≤ –º–∞–ª–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 2‚Äì3 —Ç–∏–ø–∞ –≥–∞–ª–∞–∫—Ç–∏–∫),
- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (z, z_err) —Å–æ–¥–µ—Ä–∂–∞—Ç —Ü–µ–Ω–Ω—É—é —Ñ–∏–∑–∏—á–µ—Å–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.

–ú–æ—è —Å–∏—Å—Ç–µ–º–∞ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç –ª—É—á—à—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é** –±–µ–∑ —É—á–∞—Å—Ç–∏—è —á–µ–ª–æ–≤–µ–∫–∞ ‚Äî **–∑–∞ 15‚Äì30 –º–∏–Ω—É—Ç –Ω–∞ –æ–¥–Ω–æ–º GPU**.

–ò–º–µ–Ω–Ω–æ –ø–æ—ç—Ç–æ–º—É —è –Ω–∞–∑–≤–∞–ª –µ—ë **"Progressive"** ‚Äî –æ–Ω–∞ –Ω–µ –∏—â–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∑–∞ –æ–¥–∏–Ω –ø—Ä—ã–∂–æ–∫. –û–Ω–∞ **—Ä–∞–∑–≤–∏–≤–∞–µ—Ç—Å—è, –∫–∞–∫ –∂–∏–≤–æ–π –æ—Ä–≥–∞–Ω–∏–∑–º**.

---

## üöÄ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç? (–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)

### 1. üóÉÔ∏è –î–∞–Ω–Ω—ã–µ: `Space_Galaxi` Dataset
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è `.jpg` + CSV —Å –º–µ—Ç–∫–∞–º–∏: `id`, `class`, `z`, `z_err`.
- `z` –∏ `z_err` –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∫–∞–∫ **–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –≤—Ö–æ–¥** –≤ —Å–µ—Ç—å (–Ω–µ –∫–∞–∫ –º–µ—Ç–∫–∏!), —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ —É—á–∏—Ç—ã–≤–∞—Ç—å —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞ –æ–±—ä–µ–∫—Ç–∞.
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç **—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ train/val —Å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–º seed'–æ–º**, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–æ–ª—é –≤—ã–±–æ—Ä–∫–∏ (`fraction=0.02` ‚Äî –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ 2% –¥–∞–Ω–Ω—ã—Ö).
- –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏:
  - Train: –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ (–≤–∫–ª—é—á–∞—è —Å–ª—É—á–∞–π–Ω—ã–π –ø–æ–≤–æ—Ä–æ—Ç, –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é, —à—É–º)
  - Val: —Ç–æ–ª—å–∫–æ resize + normalize (–±–µ–∑ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–π)

> ‚úÖ **–§–∏—à–∫–∞**: –Ø –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≥–æ—Ç–æ–≤—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã (ImageNet, etc). –í—Å—ë ‚Äî —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ, —Å–≤–æ–∏ –ø—É—Ç–∏, —Å–≤–æ–∏ –ª–æ–≥–∏–∫–∏. –†–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –Ω–∞ 25k –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

### 2. üèóÔ∏è –ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å: `ProgressiveModel`
- –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π CNN —Å **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –±–ª–æ–∫–æ–≤**.
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **–≤–Ω–µ—à–Ω–∏–µ –≤—Ö–æ–¥—ã** (2D –≤–µ–∫—Ç–æ—Ä: `[z, z_err]`), –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–∞–ª–µ–Ω—å–∫–∏–π MLP (`extra_proj`).
- –ö–∞–∂–¥—ã–π –±–ª–æ–∫:  
  `Conv2d ‚Üí BatchNorm ‚Üí ReLU ‚Üí Dropout2d ‚Üí MaxPool2d`
- –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –±–ª–æ–∫–∞!

### 3. üîç –ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫: `progressive_architecture_search()`
–°–µ—Ä–¥—Ü–µ –ø—Ä–æ–µ–∫—Ç–∞.

#### –ê–ª–≥–æ—Ä–∏—Ç–º:
1. –ù–∞—á–∏–Ω–∞–µ–º —Å –ø—É—Å—Ç–æ–π –º–æ–¥–µ–ª–∏ (0 –±–ª–æ–∫–æ–≤).
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞ (–¥–æ `max_layers=10`):
   - –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º **–∫–∞–Ω–¥–∏–¥–∞—Ç—ã –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞–Ω–∞–ª–æ–≤** (`k_candidates = [[9,21,54,120], ...]`)
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ `k`:
     - –î–æ–±–∞–≤–ª—è–µ–º –±–ª–æ–∫ —Å `out_channels = 3 * k`
     - –ö–æ–ø–∏—Ä—É–µ–º –≤–µ—Å–∞ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–ª–æ—è (–µ—Å–ª–∏ –µ—Å—Ç—å)
     - **–®—É–º–∏–º –≤–µ—Å–∞** (`noise_std = 0.03 * std(weights)`) ‚Äî —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã—Ö –º–∏–Ω–∏–º—É–º–æ–≤
     - –û–±—É—á–∞–µ–º 1 —ç–ø–æ—Ö—É (–±—ã—Å—Ç—Ä–æ!)
     - –ó–∞–ø–æ–º–∏–Ω–∞–µ–º –ª—É—á—à—É—é —Ç–æ—á–Ω–æ—Å—Ç—å
   - –í—ã–±–∏—Ä–∞–µ–º –ª—É—á—à–µ–≥–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ ‚Üí **–¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –≤ –º–æ–¥–µ–ª—å**
   - –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤–µ—Å–∞
3. –ï—Å–ª–∏ –Ω–∞ —à–∞–≥–µ –Ω–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è ‚Äî –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—Å—è.

#### üí° –ò–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:
- **Weight inheritance + jitter**: –ù–µ –ø–µ—Ä–µ–æ–±—É—á–∞–µ–º —Å –Ω—É–ª—è ‚Äî –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –æ–±—É—á–µ–Ω–∏–µ —Å "–ø–∞–º—è—Ç—å—é".
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π classifier**: –ü—Ä–∏ –∫–∞–∂–¥–æ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –±–ª–æ–∫–∞ ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Ä–∞–∑–º–µ—Ä –≤—Ö–æ–¥–∞ –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–π Linear-—Å–ª–æ–π.
- **–ù—É–ª–µ–≤–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç HyperOpt / Optuna**: –í—Å—ë –Ω–∞ —á–∏—Å—Ç–æ–º PyTorch ‚Äî **–Ω–µ—Ç –≤–Ω–µ—à–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫**, –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç "–∏–∑ –∫–æ—Ä–æ–±–∫–∏".

### 4. üìà –û–±—É—á–µ–Ω–∏–µ –∏ –æ—Ü–µ–Ω–∫–∞: `train_and_evaluate_model()`
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç `extra` –≤—Ö–æ–¥—ã.
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `AdamW` + `CrossEntropyLoss`.
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ª—É—á—à—É—é –º–æ–¥–µ–ª—å –ø–æ val_acc.
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤–µ—Å–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ Conv-—Å–ª–æ—è ‚Äî **–∫–ª—é—á–µ–≤–æ–π –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –º–µ–∂–¥—É —à–∞–≥–∞–º–∏**.

### 5. üìä –û—Ç—á—ë—Ç: `summarize_progressive_growth()`
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç JSON-—Ñ–∞–π–ª —Å –∏—Å—Ç–æ—Ä–∏–µ–π:  
  `{layer: 1, k: 21, channels: 63, val_acc: 0.872}`
- –°—Ç—Ä–æ–∏—Ç –≥—Ä–∞—Ñ–∏–∫: `val_acc vs layers`
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–æ–≥–¥–∞ –º–æ–¥–µ–ª—å "–ø–µ—Ä–µ—Å—Ç–∞–ª–∞ —Ä–∞—Å—Ç–∏" ‚Äî –∏–¥–µ–∞–ª—å–Ω–æ –¥–ª—è early stopping.

---

## üõ†Ô∏è –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å?

### ‚úÖ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
```bash
pip install torch torchvision pandas pillow hydra-core omegaconf matplotlib tqdm
```

### ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫:
python main.py
